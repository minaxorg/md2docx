import md2docx from '../src/md2docx/index.js';
import fs from 'fs';
import { execSync } from 'child_process';
import path from 'path';

const template = {
    "key_shortComment_fab4e57a-9ccd-42b9-80d2-dd7f535e2a95": "\n\n同学，你的作文很有深度，引经据典，展现了丰富的知识储备！不过这次的主题是推荐一个好地方，你却跑去和历史人物谈人生了，有点像去参加化装舞会，结果穿了身睡衣就出门了。小建议：下次可以试试把那些历史典故用在描述家乡美景上，比如“小溪清澈见底，仿佛能看到几千年前的故事在里面流淌”，是不是一下子就高大上了？加油，期待你下次的推荐之旅！\n\n\n\n",
    "key_personalizedWritingBase_fab4e57a-9ccd-42b9-80d2-dd7f535e2a95": "\n\n<div align=\"center\"><p><span style=\"font-size:9pt; font-weight: bold;\">我推荐的好地方——家乡的小溪</span></p></div>\n\n<p style=\"font-size:9pt; font-weight: bold;\">我最想推荐的地方是家乡的小溪。每到夏天，清澈的溪水潺潺流过，两岸绿树成荫，蝉鸣鸟叫不绝于耳，是避暑纳凉的好去处。</p>\n\n<p style=\"text-indent: 2em;\">在小溪边，我们可以捉小鱼小虾，打水漂，或是坐在大石头上读书。记得去年暑假，我和小伙伴们在这里度过了许多快乐时光。我们用网兜捞小鱼，比赛谁捉得多；用石头在水面上打水漂，看谁打得远；累了就躺在树荫下，听着溪水声和鸟鸣声，别提多惬意了。</p>\n\n<p style=\"text-indent: 2em;\">最佳游玩时间是6-8月，可以乘坐公交到镇上下车，步行15分钟就能到达。记得带上防晒用品和换洗衣物。小溪边的农家乐还可以品尝到当地的特色美食，如烤鱼、野菜等。</p>\n\n<p style=\"text-indent: 2em;\">小溪最特别的是它的水质特别清澈，可以直接看到水底的鹅卵石。阳光照射下来，溪水波光粼粼，像一颗颗闪耀的星星。每次来到这里，都能让我忘记烦恼，心情变得特别平静。</p>\n\n<p style=\"text-indent: 2em;\">这就是我推荐的小溪，它不仅风景优美，还能带来许多欢乐。希望大家有机会一定要来体验一下，相信你们也会爱上这个地方。</p>\n\n\n\n",
    "key_personalizedWritingDeep_fab4e57a-9ccd-42b9-80d2-dd7f535e2a95": "\n\n<div align=\"center\"><p><span style=\"font-size:9pt; font-weight: bold;\">夏日乐园——家乡的小溪</span></p></div>\n\n<p style=\"font-size:9pt; font-weight: bold;\">\"叮咚、叮咚\"，这是小溪在唱歌；\"沙沙、沙沙\"，这是树叶在伴奏。我要向大家推荐一个避暑胜地——家乡的小溪，它就像大自然精心打造的天然游乐场。</p>\n\n<p style=\"text-indent: 2em;\">清晨的小溪最是迷人。薄雾笼罩下，溪水泛着银光，像一条流动的绸带。岸边的野花沾着露珠，在晨光中闪闪发亮。我最爱赤脚踩在溪边的鹅卵石上，清凉的溪水漫过脚踝，小鱼儿调皮地啄着我的脚趾，痒痒的，逗得我咯咯直笑。</p>\n\n<p style=\"text-indent: 2em;\">正午时分，这里就成了我们的水上乐园。我和小伙伴们分成两队打水仗，水花四溅，欢笑声在山谷回荡。有时我们会用树枝和石头搭个小水坝，看着溪水慢慢蓄积，再突然放开，那奔腾的水流让我们兴奋得手舞足蹈。玩累了，就躺在岸边的大石头上晒太阳，听着知了的歌声，数着天上飘过的白云。</p>\n\n<p style=\"text-indent: 2em;\">傍晚的小溪又换了一副模样。夕阳把溪水染成金色，蜻蜓在水面上点出一个个小圆圈。大人们也来了，有的在浅水处洗菜，有的在岸边钓鱼。我最喜欢看爷爷钓鱼，他总说：\"这溪水养出来的鱼，味道最鲜。\"</p>\n\n<p style=\"text-indent: 2em;\">这就是我推荐的小溪，它像一位魔术师，每天都能变出不同的惊喜。如果你来玩，记得带上水枪和捞网，保管让你玩得舍不得回家！</p>\n\n<p style=\"text-indent: 2em;\">【写作思路】</p>\n<p style=\"text-indent: 2em;\">1. 立意：突出小溪作为\"夏日乐园\"的主题，展现其不同时段的魅力。</p>\n<p style=\"text-indent: 2em;\">2. 选材：选取清晨、正午、傍晚三个典型时段，通过不同活动展现小溪的乐趣。</p>\n<p style=\"text-indent: 2em;\">3. 结构：按时间顺序展开，首尾呼应，中间详写正午活动，突出重点。</p>\n<p style=\"text-indent: 2em;\">4. 技法：运用拟声词开篇吸引注意；通过动作描写、环境描写增强画面感；使用比喻、拟人等修辞手法。</p>\n\n\n\n",
    "key_generalComment_fab4e57a-9ccd-42b9-80d2-dd7f535e2a95": " \n\n1. **主题明确性**：作文内容完全偏离了“推荐一个好地方”的主题，转而讨论了“不可止”的哲学意义和历史人物的奋斗精神。因此，在主题明确性方面得分极低。\n\n2. **细节描写**：作文中几乎没有对任何具体地点的细节描写，而是大量引用了历史人物和事件。在细节描写方面表现不佳。\n\n3. **逻辑与完整性**：虽然作文在讨论“不可止”时有一定的逻辑性，但整体结构与习作要求不符，缺乏推荐地方的结构和逻辑。\n\n4. **语言表达**：作文语言较为流畅，但缺乏生动性和修辞手法，整体语言风格较为平淡。\n\n5. **创新与情感**：作文在创新性方面表现一般，虽然引用了历史人物，但缺乏个人视角和情感表达。\n\n6. **信息完整性**：作文没有提供任何关于推荐地方的实用信息，如如何到达、最佳时间等，因此在信息完整性方面得分极低。\n\n\n\n",
    "key_detailedCorrection_fab4e57a-9ccd-42b9-80d2-dd7f535e2a95": "\n\n| 原文段落内容 | 段落点评及修改建议 | 润色后段落内容 |\n|--------------|---------------------|-----------------|\n| 振兴的路上。\"未惜头颅兴故土,甘将可止\"的责任,\"长风破浪会有时,直挂生命不息,前行不止热血沃中华\",赵一曼在革命时期说出云帆济沧海\"不停奋勇,创设中华之新 | 该段落完全偏离主题，引用了大量革命历史内容，与\"推荐一个好地方\"无关。建议删除这些内容，转而描述一个具体的地方及其特色。 | 我最想推荐的地方是家乡的小溪。每到夏天，清澈的溪水潺潺流过，两岸绿树成荫，蝉鸣鸟叫不绝于耳，是避暑纳凉的好去处。 |\n| 止,停止,后而引出放弃之意。的话,\"寄意寒星荃不雀,我以我血鉴篇章!《论语》有言\"譬如为山,未成一篑,止,轩辕\"是鲁迅的豪言,他们走的人生路吾止也\",但人生便是一场无尽的旅途没有归路,但有复兴中华的耀眼光茫,不可止,便要我们前行不止 | 这段继续讨论人生哲理和历史人物，与主题不符。建议改为描述推荐地方的具体活动和体验。 | 在小溪边，我们可以捉小鱼小虾，打水漂，或是坐在大石头上读书。记得去年暑假，我和小伙伴们在这里度过了许多快乐时光。 |\n| 他们知道这条路充满杀机,仍义无反不可止,是因为人生如逆水行舟。顾地走下去,永不停止不进则退。曾记否?当年清朝闭关锁不可止,是因为我们肩负着使命。 | 这段历史论述与推荐地方无关。建议改为介绍推荐地方的实用信息，如最佳游玩时间和交通方式。 | 最佳游玩时间是6-8月，可以乘坐公交到镇上下车，步行15分钟就能到达。记得带上防晒用品和换洗衣物。 |\n| \"岖,山而高也\",崛起一词,涵盖了伍于世界,饱受列强欺辱。是否知道中华上下五千年人们的梦想与使命沙皇专治下,俄国的黑暗迫害了多少周恩来总理在说出\"为中华之崛起而读想前行的共产主义青年,让社会更加书\"时,心中便知晓他肩负起了这使命,动荡不堪,因为停下了自己的脚步不可止\"。 | 这段历史政治内容与主题无关。建议改为描述推荐地方的独特之处和个人感受。 | 小溪最特别的是它的水质特别清澈，可以直接看到水底的鹅卵石。每次来到这里，都能让我忘记烦恼，心情变得特别平静。 |\n| 马拉松的来源,便是为了纪导致我们不断退步,是否体会过?如余一位为传递重要战争信息,坚持跑一汪清泉,前行,便可成大江大河;了几十公里的人而设立的,他知道这正步,便会成为一滩死水。我们从不条信息关乎到他们整个国家的存亡。应像穴兽一般在洞穴中等待死亡的阵脚下的步伐一步不停,信息传到后,临,而应像薄公英般,哪怕自己再柔信使命完成了,自己也牺牲了,他也弱渺小,也会乘风远航,起舞许映证了\"生命不息,前行不止。 | 这段比喻和典故与主题无关。建议改为总结推荐理由和邀请。 | 这就是我推荐的小溪，它不仅风景优美，还能带来许多欢乐。希望大家有机会一定要来体验一下，相信你们也会爱上这个地方。 |\n\n\n\n",
    "key_personalizedWritingExercise_fab4e57a-9ccd-42b9-80d2-dd7f535e2a95": "\n\n**练习一：主题聚焦**\n\n*   题目：请你选择一个你喜欢的地方，例如学校的操场、家里的阳台、公园的角落，用一句话概括出这个地方最吸引你的特点。\n*   提示：想想这个地方带给你什么样的感受？是快乐、平静、还是舒适？\n*   参考答案：我喜欢学校的操场，因为那里充满了活力和欢笑。\n\n**练习二：细节描写**\n\n*   题目：请你选择一个你熟悉的事物，例如你最喜欢的玩具、你养的小宠物、你家的一件家具，用至少三个细节描写来展现它的特点。\n*   提示：可以从颜色、形状、声音、气味、触感等方面入手。\n*   参考答案：我最喜欢的玩具是一只毛茸茸的小熊，它有着棕色的卷毛、圆溜溜的黑眼睛、和一个歪歪扭扭的红鼻子。\n\n**练习三：逻辑构建**\n\n*   题目：请你写一段话，介绍你最喜欢的一道菜，要按照“是什么-为什么-怎么样”的逻辑顺序来组织内容。\n*   提示：先介绍菜名，然后说明你喜欢的原因，最后介绍这道菜的做法。\n*   参考答案：我最喜欢的一道菜是番茄炒蛋。我喜欢它酸甜可口的味道，而且做法简单。先把鸡蛋打散，然后把番茄切块，锅里放油烧热，先炒鸡蛋，再加入番茄一起炒，最后放点盐和糖调味就可以了。\n\n**练习四：情感表达**\n\n*   题目：请你回忆一件让你感到特别开心的事情，用一段话表达出你当时的心情。\n*   提示：可以运用一些修辞手法，如比喻、拟人等，来增强表达效果。\n*   参考答案：那天我考试得了满分，心里像开了花一样，阳光都变得格外灿烂。我迫不及待地跑回家，想把这个好消息告诉妈妈。\n\n**练习五：信息补充**\n\n*   题目：如果你要向朋友推荐你去过的某个景点，除了介绍景点本身的特色，还需要提供哪些实用信息？\n*   提示：可以从交通、住宿、餐饮、游玩时间等方面考虑。\n*   参考答案：除了介绍景点的美景，我还需要告诉朋友怎么去、在哪里住、吃什么好、玩几天合适。"
}
const mdPath = path.join(process.cwd(), 'test', 'testLayout.md');
const md = fs.readFileSync(mdPath, 'utf-8');

const outputPath = path.join(process.cwd(), 'test', 'testTempleandFont.docx');

// md2docx 返回 Promise<Buffer>，需要使用 await
const buffer = await md2docx(md, { templates: template,styleOptions:{
    defaultFontSize:18
} });

// 将 buffer 写入文件
fs.writeFileSync(outputPath, buffer);

console.log(`文档已成功生成: ${outputPath}`);

// 自动打开生成的文档
try {
    execSync(`start "" "${outputPath}"`, { shell: true });
} catch (error) {
    console.log('无法自动打开文档,请手动打开:', outputPath);
}