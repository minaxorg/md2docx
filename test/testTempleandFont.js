import md2docx from '../src/md2docx/index.js';
import fs from 'fs';
import { execSync } from 'child_process';
import path from 'path';

const template = {
    "key_shortComment_c058eded-6048-4c91-aef2-b10238d16393": "\n\n同学，你的西湖一日游记写得像一本“景点打卡手册”，热情满满！不过想让读者也身临其境，记得多加点“旅行小贴士”，比如几点去最合适，哪里拍照最美。可以试着把叫花鸡描述得更香一些，让大家隔着屏幕都流口水！下次记得把每个景点都“精装修”一下，多加细节描写，让文章更生动有趣。加油，期待你下次更精彩的游记！\n\n\n\n",
    "key_personalizedWritingBase_c058eded-6048-4c91-aef2-b10238d16393": "\n\n<div align=\"center\"><b><font size=\"5\">我推荐的好地方——西湖</font></b></div>\n<br>\n<p style=\"text-indent: 2em;\">我强烈推荐杭州西湖这个人间仙境。这里不仅有“接天莲叶无穷碧”的荷花池，还有“柳浪闻莺”的醉人景致，三步一景，五步一画，美不胜收。</p>\n<p style=\"text-indent: 2em;\">春暖花开时节，湖畔垂柳抽出嫩绿的新芽，宛如少女的秀发随风轻舞。粉红的桃花竞相绽放，与碧绿的湖水相映成趣，偶尔还能听到黄莺在枝头婉转歌唱。</p>\n<p style=\"text-indent: 2em;\">炎炎夏日，租一艘小船泛舟湖上，微风拂面，荷香阵阵，让人暑意全消。金秋时节，漫步苏堤，看层林尽染，枫叶如火，仿佛置身于一幅流动的油画中。</p>\n<p style=\"text-indent: 2em;\">游览之余，一定要尝尝地道的杭帮菜。楼外楼的叫花鸡香气扑鼻，肉质鲜嫩，配上西湖醋鱼的酸甜可口，让人回味无穷。这些美食与美景相得益彰，构成了独特的西湖记忆。</p>\n<p style=\"text-indent: 2em;\">西湖四季皆美，处处是景。无论是踏春赏花，还是秋日观叶，这里都能带给你难忘的体验。相信你一定会爱上这个“人间天堂”！</p>\n\n\n\n",
    "key_personalizedWritingDeep_c058eded-6048-4c91-aef2-b10238d16393": "\n\n<div align=\"center\"><b><font size=\"5\">西湖四季游</font></b></div>\n<br>\n<p style=\"text-indent: 2em;\">\"欲把西湖比西子，淡妆浓抹总相宜。\"苏轼笔下的西湖，正是我要向大家推荐的人间胜境。这里四季如画，处处是诗，让人流连忘返。</p>\n<p style=\"text-indent: 2em;\">春天的西湖最是温柔。漫步白堤，两岸垂柳轻拂水面，嫩绿的枝条上点缀着点点新芽，像极了少女的发辫。桃花、樱花竞相绽放，粉白相间，倒映在碧绿的湖水中，构成一幅天然的画卷。偶尔还能听见黄莺在枝头婉转歌唱，为这幅春景图配上了最美的背景音乐。</p>\n<p style=\"text-indent: 2em;\">夏日里，西湖摇身一变成了避暑胜地。租一艘小船，在荷塘中穿行，看接天莲叶无穷碧，赏映日荷花别样红。微风拂过，荷香阵阵，暑气顿消。傍晚时分，雷峰夕照的美景更是不容错过，金色的阳光洒在湖面上，波光粼粼，美不胜收。</p>\n<p style=\"text-indent: 2em;\">金秋时节，西湖换上了华丽的盛装。苏堤两旁的枫叶渐次变红，远远望去，宛如一条火红的绸带。漫步其中，脚下是沙沙作响的落叶，眼前是层林尽染的秋色，让人不禁想起\"停车坐爱枫林晚，霜叶红于二月花\"的千古名句。</p>\n<p style=\"text-indent: 2em;\">即便是冬日，西湖也别有一番韵味。断桥残雪的景致闻名遐迩，银装素裹的湖山胜景，让人仿佛置身于水墨画中。若是赶上下雪天，一定要去孤山赏梅，看红梅傲雪绽放，感受\"梅须逊雪三分白，雪却输梅一段香\"的诗意。</p>\n<p style=\"text-indent: 2em;\">游览之余，不妨去楼外楼品尝地道的杭帮菜。叫花鸡的香气扑鼻，西湖醋鱼的酸甜可口，龙井虾仁的清香四溢，每一道菜都让人回味无穷。这些美食与美景相得益彰，共同构成了西湖独特的魅力。</p>\n<p style=\"text-indent: 2em;\">西湖的美，说不尽，道不完。它像一位千面佳人，每个季节都展现出不同的风姿。无论是踏春赏花，还是秋日观叶，这里都能带给你难忘的体验。相信你一定会爱上这个\"人间天堂\"！</p>\n\n<br><br>\n<b>写作思路：</b>\n1. 立意：以\"西湖四季之美\"为主线，突出其作为\"人间天堂\"的独特魅力\n2. 选材：精选四季代表性景观（春柳、夏荷、秋枫、冬雪）和特色美食\n3. 结构：采用总分总结构，以诗句开篇，按季节顺序展开，结尾升华主题\n4. 技法：运用多感官描写、引用古诗名句、比喻拟人等修辞手法\n5. 语言：保持原文活泼风格，同时提升文学性和感染力\n\n\n\n",
    "key_generalComment_c058eded-6048-4c91-aef2-b10238d16393": " \n\n1. **内容深度**：作文中对推荐的地方有一定的描述，但缺乏深入的观察和细腻的描绘，未能充分展现该地方的独特魅力。\n2. **结构逻辑**：文章结构较为清晰，但段落之间的过渡不够自然，逻辑关系有待加强。\n3. **语言运用**：语言表达较为平淡，缺乏生动的修辞和丰富的语言风格，未能有效吸引读者。\n4. **创新点**：作文中缺乏独特的个人视角和新颖的比喻，创新性不足。\n5. **情感表达**：情感表达较为表面，未能深入体现作者对该地方的亲身感受和情感共鸣。\n6. **信息完整性**：提供了一些基本信息，但关于如何到达、最佳时间等实用信息不够详细，影响读者的判断。\n\n\n\n",
    "key_detailedCorrection_c058eded-6048-4c91-aef2-b10238d16393": "\n\n| 原文段落内容 | 段落点评及修改建议 | 润色后段落内容 |\n|--------------|---------------------|----------------|\n| 我推荐的地方是西湖。西湖很美，有很多树和花。 | 1. 开篇点题但过于简单<br>2. \"很美\"表述笼统<br>3. 缺乏具体细节描写<br>建议：补充西湖的具体特色景观，使用更生动的形容词 | 我强烈推荐杭州西湖这个人间仙境。这里不仅有\"接天莲叶无穷碧\"的荷花池，还有\"柳浪闻莺\"的醉人景致，三步一景，五步一画，美不胜收。 |\n| 春天的时候，柳树发芽了，桃花开了。 | 1. 季节特征描写准确但平淡<br>2. 缺乏感官细节<br>建议：加入视觉、听觉等多感官描写，使用比喻修辞 | 春暖花开时节，湖畔垂柳抽出嫩绿的新芽，宛如少女的秀发随风轻舞。粉红的桃花竞相绽放，与碧绿的湖水相映成趣，偶尔还能听到黄莺在枝头婉转歌唱。 |\n| 夏天可以划船，秋天可以看红叶。 | 1. 活动描写过于简略<br>2. 缺乏参与感<br>建议：补充具体活动体验，加入个人感受 | 炎炎夏日，租一艘小船泛舟湖上，微风拂面，荷香阵阵，让人暑意全消。金秋时节，漫步苏堤，看层林尽染，枫叶如火，仿佛置身于一幅流动的油画中。 |\n| 西湖边有很多好吃的，我最喜欢叫花鸡。 | 1. 饮食描写突兀<br>2. 缺乏与景点的联系<br>建议：将美食与景观结合，补充特色细节 | 游览之余，一定要尝尝地道的杭帮菜。楼外楼的叫花鸡香气扑鼻，肉质鲜嫩，配上西湖醋鱼的酸甜可口，让人回味无穷。这些美食与美景相得益彰，构成了独特的西湖记忆。 |\n| 希望大家都能来西湖玩。 | 1. 结尾仓促<br>2. 缺乏感染力<br>建议：总结特色，增强号召力 | 西湖四季皆美，处处是景。无论是踏春赏花，还是秋日观叶，这里都能带给你难忘的体验。相信你一定会爱上这个\"人间天堂\"！ |\n\n\n\n",
    "key_personalizedWritingExercise_c058eded-6048-4c91-aef2-b10238d16393": "\n\n**练习一：细节描写大挑战**\n\n*   **题目：** 选择你最喜欢的西湖景点（如苏堤春晓、断桥残雪、三潭印月），用不少于100字的篇幅，进行细致的描写。\n*   **提示：** 调动你的视觉、听觉、嗅觉、味觉和触觉，尽可能地展现景点的独特魅力。可以运用比喻、拟人等修辞手法，让文字更加生动形象。\n*   **参考答案：**（以“三潭印月”为例）\n    远眺三潭印月，湖面上三个石塔静静伫立，宛如三颗黑珍珠，在波光粼粼的湖水中闪耀着神秘的光芒。微风拂过，湖面泛起层层涟漪，倒映着天空的颜色，如同一面巨大的镜子。夜晚，塔中点亮灯火，倒映在湖中的月亮也随之晃动，真假难辨，如梦如幻。\n\n**练习二：情感表达小剧场**\n\n*   **题目：** 回忆一次你在西湖游玩的经历，写一段文字，表达你当时的心情和感受。\n*   **提示：** 可以从你最喜欢的景点、美食、活动等方面入手，描述你当时的所见、所闻、所感。尝试运用一些抒情的语句，让文字更富有感染力。\n*   **参考答案：**\n    记得那次在西湖边漫步，阳光洒在身上，暖洋洋的。湖面上微波荡漾，远处传来阵阵鸟鸣，让人感到无比的宁静和放松。那一刻，仿佛所有的烦恼都烟消云散，只剩下与大自然融为一体的愉悦。\n\n**练习三：信息整合小能手**\n\n*   **题目：** 假如你要向一位从未去过西湖的朋友推荐西湖，你会告诉他哪些实用信息？\n*   **提示：** 可以从交通方式、最佳旅游时间、必游景点、特色美食等方面入手，提供详细的信息，帮助朋友更好地了解西湖。\n*   **参考答案：**\n    去西湖旅游，可以乘坐地铁或公交车到达。最佳旅游时间是春秋两季，气候宜人。必游景点有苏堤、断桥、三潭印月、雷峰塔等。特色美食有叫花鸡、西湖醋鱼、龙井虾仁等。记得提前预订酒店和船票哦！"
}
const mdPath = path.join(process.cwd(), 'test', 'testLayout.md');
const md = fs.readFileSync(mdPath, 'utf-8');

const outputPath = path.join(process.cwd(), 'test', 'testTempleandFont.docx');

// md2docx 返回 Promise<Buffer>，需要使用 await
const buffer = await md2docx(md, { templates: template,styleOptions:{
    defaultFontSize:18
} });

// 将 buffer 写入文件
fs.writeFileSync(outputPath, buffer);

console.log(`文档已成功生成: ${outputPath}`);

// 自动打开生成的文档
try {
    execSync(`start "" "${outputPath}"`, { shell: true });
} catch (error) {
    console.log('无法自动打开文档,请手动打开:', outputPath);
}